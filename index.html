<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <link rel="stylesheet" href="css/style.css">
  </head>
  <body>
    <div id="wrapper" class="container">
      <h1>CSC465 Final Project D3 Visualization</h1>
      <div class="row">
        <div id="detail" class="col-md-2">
          <a href="tooltip" class="thumbnail">
            <p>
            Show each tract details 
            Show each tract details 
            Show each tract details 
            Show each tract details 
            Show each tract details 
            Show each tract details 
            </p>
          </a>
          <a id="legend" href="#" class="thumbnail">
            <p>
            Show color scale legend
            Show color scale legend
            Show color scale legend
            Show color scale legend
            Show color scale legend
            Show color scale legend
            </p>
          </a>
          <a id="legend" href="#" class="thumbnail">
            <p>
            Show stats explanation 
            Show stats explanation
            Show stats explanation
            Show stats explanation
            Show stats explanation
            Show stats explanation
            </p>
          </a>
        </div>
        <div id="svg" class="col-md-8 well">
        </div>
        <div id="option" class="btn-group-vertical col-md-2" role="group" aria-label="btn-group">
          <button id="stat1" type="button" class="btn btn-primary">Population</button>
          <button id="stat2" type="button" class="btn btn-primary">Vacant Unit</button>
          <button id="stat3" type="button" class="btn btn-primary">House Unit</button>
          <button id="stat4" type="button" class="btn btn-primary">5-7 People Household</button>
          <button id="stat5" type="button" class="btn btn-success">Built before 1939</button>
          <button id="stat6" type="button" class="btn btn-success">Built 1940 to 1959</button>
          <button id="stat7" type="button" class="btn btn-warning">Income: 25K to 50K</button>
          <button id="stat8" type="button" class="btn btn-warning">Income: 50K to 75K</button>
          <button id="stat9" type="button" class="btn btn-danger">Edu: High school/less</button>
          <button id="stat10" type="button" class="btn btn-danger">Edu: College</button>
        </div>
      </div>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
    <script src="//d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <script>

      var width = 1000, height = 700;
      var color = d3.hcl(-97, 32, 52);

      var projection = d3.geo.mercator()
        .center([-87.6847,41.8369])
        .scale(70000)
        .translate([width/2,height/2]);

      var path = d3.geo.path()
        .projection(projection);

      var svg = d3.select("#svg").append("svg")
        .attr("width", width)
        .attr("height", height)
        .style("fill",color);

      var censusData = {};
      d3.json("./data/datause1filtered.json",function(stat){
        censusData = stat;
      });

      var censusVarMap = {
        "stat1": "Change_Population",
        "stat2": "Change_VacantUnits",
        "stat3": "Change_HouseUnits",
        "stat4": "Change_5To7_or_more_person_household",
        "stat5": "Change_Builst1939earlier",
        "stat6": "Change_Built_1940to1959",
        "stat7": "Y00_PCT_Units_HHIncome_25to50k",
        "stat8": "Y00_PCT_Units_HHIncome_50to75k",
        "stat9": "Chg_Educate_HighSchool_orLess",
        "stat10": "Chg_Educate_SomeCollege"
      }

      function updateColorLegend(){
      }

      function updateStatExplanation(){
      }

      function renderSVG(censusStat){
        var index = 0;
        d3.selectAll("svg > *").remove();

        d3.json("./data/chicagogeo.json", function(chicago) {
          chicago.features.forEach(function(tract){
            if(tract.properties.geoid10 == censusData[index].censusTract){
              tract.properties.value = censusData[index][censusStat];
              index += 1;
            } else {
              tract.properties.value = 0;
            }

            tract.properties.color = d3.interpolate("#003366", "#cc0000")(tract.properties.value*10);
          });

          svg.selectAll(".state")
            .data(chicago.features)
            .enter()
            .append("path")
            .style("fill",function(d){return d.properties.color;})
            .style('stroke', 'black')
            .style('stroke-width', '0.3')
            .attr("d", path);
        });
      }

      renderSVG("Change_Population");

      $("button").click(function(){
        renderSVG(censusVarMap[$(this).attr('id')]);
      });

    </script>
  </body>
</html>
